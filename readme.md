# Асинхронные методы

Когда приложение выполняется синхронно, каждый метод(поток) выполняется в зависимости от того успел ли он перехватить ресурсы, методы выполняеются в разнобой.

Асинхронные методы нужны для того чтобы приложение работало и не ждало пока выполнится какой-либо метод(например метод получения данных с API или бд)

## Пример:

1. Синхронный метод,который мы должны сделать ассинхронным:

```
 static bool SaveFile(string path)
        {
            var rnd = new Random();
            var text = "";
            for(int i = 0;i< 50000; i++)
            {
                text +=rnd.Next();
            }

            using (var sw = new StreamWriter(path, false, Encoding.UTF8))
            {
                sw.WriteLine();
            }
            return true;

        }
```
Этот метод сохраняет на диск файл с рандомными числами, всего будет 50 тысяч чисел, очевидно этот метод будет выполняться долго и чтобы пользователь не смотрел в пустоту его можно выполнить асинхронно(т.е он будет выполняться и при этом пользователь может взаимодействовать с приложенеим не ожидая результата выполнения метода)

2. Для того чтобы сделать метод синхронным, его лишь нужно завернуть в конструкцию:

```
 static async Task<bool> SaveFileAsync(string path)
        {
            //ключевое слово await говорит нам о том, что мы
            //Ожидаем пока выполнится метод и только после этого возвращаем результат выполнения метода
            var result = await Task.Run(() => SaveFile(path));
            return result;
            
               
           

        }
```
Тут мы просто создали переменную и пихнули в неё наш метод и сказали что нужно подождать пока он выполнится и только после этого вернуть результат

3. Далее в основном методе(потоке) в котором нам нужно вызвать асинхронный пишем так:
```
  var result = SaveFileAsync("d:\\test.txt");
            var input = Console.ReadLine();
            Console.WriteLine(result.Result);
            Console.ReadLine();
```
Тут мы создали переменную result и в неё засунули наш асинхронный метод, в параметрах указали путь куда наш метод будет сохранять файл

Переменная input позволяет пользователю вводить текст на консоли, то есть если бы метод был синхронным то пользователь ничего бы не мог делать,кроме как дожидаться пока метод вернёт ему результат, а этот процесс может занимать продолжительное время, следовательно синхронный метод выполняется и пользователь не ждёт его чтобы взаимодействовать с приложением.

# Вывод

Асинхронные методы выполняются в основном методе, при этом пока асинхронный метод выполняется, могут работать другие методы приложения,это позволяет нам создать последовательность методов.